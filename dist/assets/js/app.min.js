console.log("bla appjs"),$(function(){$('[data-toggle="tooltip"]').tooltip()});var addedKBmaps=[];function Map(e){this.name=e,this.mapMarkers=[],this.maxZindex=2,this.openedModals=[],this.container=jQuery("#"+this.name+" .KBmap__mapContainer .KBmap__mapHolder"),this.mapDataJSON,this.addMarker=function(e,t,a,r){var i;i=void 0!==r?generateUniqueMarkerName(this,r):generateUniqueMarkerName(this),this.mapMarkers[i]=new MapMarker(i,e,t,a,this)},this.removeMarker=function(e){this.mapMarkers[e].removeMarker()},this.importJSON=function(e){for(importedMarkerName in this.mapDataJSON=e,this.mapDataJSON)this.addMarker(this.mapDataJSON[importedMarkerName].icon,this.mapDataJSON[importedMarkerName].cordX,this.mapDataJSON[importedMarkerName].cordY,importedMarkerName),this.mapDataJSON[importedMarkerName].modal&&this.mapDataJSON[importedMarkerName].modal.title&&this.mapDataJSON[importedMarkerName].modal.content&&this.mapMarkers[importedMarkerName].addModal(this.mapDataJSON[importedMarkerName].modal.title,this.mapDataJSON[importedMarkerName].modal.content)},this.generateJSON=function(){},this.showAllMapMarkers=function(){for(mapMarker in this.mapMarkers)"removeElement"!=mapMarker&&this.mapMarkers[mapMarker].show()},this.closeAllModals=function(){for(var e=this.openedModals.length-1;0<=e;e--)this.openedModals[e].closeModal()}}function MapMarker(e,t,a,r,i){this.map=i,this.name=e,this.icon=t,this.cordX=a,this.cordY=r,this.markerContainer=this.map.container,this.modal,this.addModal=function(e,t){this.modal=new MarkerModal(e,t,this)},this.activate=function(){jQuery('[data-marker-name="'+this.name+'"]').addClass("active")},this.deactivate=function(){jQuery('[data-marker-name="'+this.name+'"]').removeClass("active")},this.setCurrent=function(){jQuery('[data-marker-name="'+this.name+'"]').css("z-index",this.map.maxZindex),this.map.maxZindex++},this.unsetCurrent=function(){jQuery('[data-marker-name="'+this.name+'"]').css("z-index","1")},this.generateMarker=function(){return output='<div class="KBmap__marker" data-marker-name="'+this.name+'" style="left: '+this.cordX+"%; top: "+this.cordY+'%"><img src="'+this.icon+'" alt="'+this.location+'"></div>',output},this.removeMarker=function(){jQuery('[data-marker-name="'+this.name+'"]').remove(),delete this.map.mapMarkers[this.name],this.map.openedModals.removeElement(this.modal)},this.show=function(){this.markerContainer.append(this.generateMarker())}}function MarkerModal(e,t,a){this.title=e,this.linkedMapMarker=a,this.content=t,this.positionedElemOffsetX=null,this.positionedElemOffsetY=null,(self=this).generateModal=function(){return output='<div  class="KBmap__markerContent"><div class="KBmap__markerClose"><i class="fa fa-times" aria-hidden="true"></i></div><h3 class="KBmap__markerTitle">'+this.title+"</h3>",output+='<div class="KBmap__markerContentItem">'+this.content+"</div>",output+="</div>",output},this.isModalActive=function(){return jQuery('[data-marker-name="'+this.linkedMapMarker.name+'"]').hasClass("active")},this.closeModal=function(){jQuery('[data-marker-name="'+this.linkedMapMarker.name+'"] .KBmap__markerContent').remove(),this.linkedMapMarker.map.openedModals.removeElement(this),this.linkedMapMarker.deactivate(),this.linkedMapMarker.unsetCurrent(),this.linkedMapMarker.map.openedModals.length<1&&(this.linkedMapMarker.map.maxZindex=2)},this.openModal=function(){this.linkedMapMarker.activate(),this.linkedMapMarker.setCurrent(),jQuery('[data-marker-name="'+this.linkedMapMarker.name+'"]').append(this.generateModal()),this.linkedMapMarker.map.openedModals.push(this),this.clearPosition()},this.toggleModal=function(){this.isModalActive()?this.closeModal():this.openModal()},this.clearPosition=function(){$markerContentWidth=jQuery('[data-marker-name="'+this.linkedMapMarker.name+'"]').find(".KBmap__markerContent").outerWidth(),$markerContentHeight=jQuery('[data-marker-name="'+this.linkedMapMarker.name+'"]').find(".KBmap__markerContent").outerHeight(),$markerContentWidth>jQuery(window).outerWidth()&&($markerContentWidth=jQuery(window).outerWidth()-1),$markerWidth=jQuery(".KBmap__marker").outerWidth(),$markerHeight=jQuery(".KBmap__marker").outerHeight(),$positionedElem=jQuery('[data-marker-name="'+this.linkedMapMarker.name+'"]').find(".KBmap__markerContent"),self.positionedElemOffsetX=-$markerContentWidth/2+$markerWidth/2,self.positionedElemOffsetY=1.5*$markerHeight,console.log($markerWidth),console.log($markerHeight),console.log($markerContentWidth),$positionedElem.css({left:self.positionedElemOffsetX,top:self.positionedElemOffsetY,"max-width":jQuery(window).outerWidth()}),function(){for(;$positionedElem.offset().left<0&!($positionedElem.offset().left+$markerContentWidth>jQuery(window).outerWidth());)self.positionedElemOffsetX+=1,$positionedElem.css({left:self.positionedElemOffsetX,bottom:self.positionedElemOffsetY,"max-width":jQuery(window).outerWidth()-1});for(;$positionedElem.offset().left+$markerContentWidth>jQuery(window).outerWidth()&!($positionedElem.offset().left<0);)self.positionedElemOffsetX+=-1,$positionedElem.css({left:self.positionedElemOffsetX,bottom:self.positionedElemOffsetY,"max-width":jQuery(window).outerWidth()-1});for(;$positionedElem.offset().top<0;)self.positionedElemOffsetY+=-1,$positionedElem.css({left:self.positionedElemOffsetX,bottom:self.positionedElemOffsetY,"max-width":jQuery(window).outerWidth()-1})}()}}function generateName(e){return e+Math.floor(1e3*Math.random()+1)}function generateUniqueMarkerName(e,t){var a,r="mapMarker";a=void 0!==t?t:generateName(r);for(var i=0;e.mapMarkers[a];)if(a=generateName(r),1e3<++i)return console.error("After 10000 tries couldnt generate unique name for MapMarker object. Change max number in MapMarker object name [function generateName()]. Default max: 1000"),!1;return a}function getKBmap(e){for(var t=0,a=addedKBmaps.length;t<a;t++)if(addedKBmaps[t].name==e)return addedKBmaps[t]}function createKBmap(e,t,a){var r='<div class="KBmap__mapContainer"><div class="KBmap__mapHolder"><img src="'+t+'" alt="mapa"></div></div>';jQuery("#"+e).append(r),window[e]=new Map(e,a),addedKBmaps.push(window[e])}Array.prototype.removeElement=function(e){var t=this.indexOf(e);-1<t&&this.splice(t,1)},jQuery(document).ready(function(){jQuery(window).resize(function(){addedKBmaps.forEach(function(e){e.openedModals.forEach(function(e){e.clearPosition()})})}),jQuery("body").on("click",".KBmap__marker img",function(){var e=jQuery(this).parent().attr("data-marker-name"),t=jQuery(this).parent().parent().parent().parent().attr("id");jQuery.event.trigger("markerClick",getKBmap(t).mapMarkers[e])}),jQuery("body").on("click",".KBmap__markerClose",function(e){e.stopPropagation();var t=jQuery(this).parent().parent().attr("data-marker-name"),a=jQuery(this).parent().parent().parent().parent().parent().attr("id");jQuery.event.trigger("markerClose",getKBmap(a).mapMarkers[t])}),jQuery("body").on("click",".KBmap__markerContent",function(){var e=jQuery(this).parent().attr("data-marker-name");getKBmap(jQuery(this).parent().parent().parent().parent().attr("id")).mapMarkers[e].setCurrent()}),jQuery(document).on("markerClick",function(e,t){t.modal.toggleModal()}),jQuery(document).on("markerClose",function(e,t){t.modal.closeModal()})});
//# sourceMappingURL=app.min.js.map
